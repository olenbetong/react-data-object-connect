(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.dataObjectConnect=b()})(this,function(){"use strict";function a(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function b(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function c(a,c,d){return c&&b(a.prototype,c),d&&b(a,d),a}function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function e(){return e=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},e.apply(this,arguments)}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&h(a,b)}function g(a){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},g(a)}function h(a,b){return h=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},h(a,b)}function i(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function j(a,b){return b&&("object"==typeof b||"function"==typeof b)?b:i(a)}var k=["AllowDeleteChanged","AllowUpdateChanged","AllowInsertChanged","SaveFailed","PartialDataLoaded","DataLoadFailed","FieldChanged","RecordCreated","RecordRefreshed","RecordDeleting","RecordDeleted","AfterSave","BeforeLoad","BeforeSave","CancelEdit","CurrentIndexChanged","DataLoaded","DirtyChanged"],l=function(b){var h=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];return function(l){var m=/*#__PURE__*/function(m){function n(c){var e;a(this,n),e=j(this,g(n).call(this,c)),d(i(i(e)),"updateData",function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(h){var c=b.currentRow();e.setState(Object.assign(c,a))}else{var d=b.getData(),f=b.currentRow();e.setState(Object.assign({current:f,data:d},a))}}),d(i(i(e)),"handleAllowDeleteChanged",function(a){return e.setState({canDelete:a})}),d(i(i(e)),"handleAllowUpdateChanged",function(a){return e.setState({canUpdate:a})}),d(i(i(e)),"handleAllowInsertChanged",function(a){return e.setState({canInsert:a})}),d(i(i(e)),"handleSaveFailed",function(){return e.setState({saveFailed:!0})}),d(i(i(e)),"handlePartialDataLoaded",function(){return null}),d(i(i(e)),"handleDataLoadFailed",function(a){a?e.setState({isLoading:!1,loadError:a}):e.setState({isLoading:!1})}),d(i(i(e)),"handleFieldChanged",e.updateData),d(i(i(e)),"handleRecordCreated",e.updateData),d(i(i(e)),"handleRecordRefreshed",e.updateData),d(i(i(e)),"handleRecordDeleting",function(){return e.setState({isDeleting:!0})}),d(i(i(e)),"handleRecordDeleted",function(){return e.updateData({isDeleting:!1})}),d(i(i(e)),"handleAfterSave",function(){return e.updateData({isSaving:!1})}),d(i(i(e)),"handleBeforeLoad",function(){return e.setState({isLoading:!0})}),d(i(i(e)),"handleBeforeSave",function(){return e.setState({isSaving:!0,saveFailed:!1})}),d(i(i(e)),"handleCancelEdit",function(){return e.updateData({isSaving:!1})}),d(i(i(e)),"handleCurrentIndexChanged",function(a){h?e.updateData():(e.updateData(),e.setState({currentIndex:a}))}),d(i(i(e)),"handleDataLoaded",function(){return e.updateData({isLoading:!1,isSaving:!1,isDeleting:!1,saveFailed:!1})}),d(i(i(e)),"handleDirtyChanged",function(){return e.setState({isDirty:b.isDirty()})}),d(i(i(e)),"setFieldValue",function(a,c){b.currentRow(a,c),e.updateData()}),d(i(i(e)),"setFieldValues",function(a){for(var c in a)a.hasOwnProperty(c)&&b.currentRow(c,a[c]);e.updateData()});var f={};if(h){var k=!0,l=!1,m=void 0;try{for(var o,p,q=b.getFields()[Symbol.iterator]();!(k=(o=q.next()).done);k=!0)p=o.value,f[p.name]=null}catch(a){l=!0,m=a}finally{try{k||null==q.return||q.return()}finally{if(l)throw m}}}else f.data=[];return e.state=Object.assign({canDelete:b.isDeleteAllowed(),canUpdate:b.isUpdateAllowed(),canInsert:b.isInsertAllowed(),currentIndex:b.getCurrentIndex(),isDirty:b.isDirty(),isDeleting:!1,isLoading:!1,isSaving:!1,loadError:null,saveFailed:!1},f),e}return f(n,m),c(n,[{key:"componentDidMount",value:function(){for(var a,c=0;c<k.length;c++)a=k[c],b.attachEvent("on"+a,this["handle"+a]);this.updateData()}},{key:"componentWillUnmount",value:function(){for(var a,c=0;c<k.length;c++)a=k[c],b.detachEvent("on"+a,this["handle"+a])}},{key:"cancelEdit",value:function(){b.cancelEdit()}},{key:"deleteRow",value:function(a){return new Promise(function(c){var d=function(a,b){c({data:b,error:a})};h?b.deleteCurrentRow(d):b.deleteRow(a,d)})}},{key:"endEdit",value:function(a){return new Promise(function(c){b.endEdit(function(b,d){"function"==typeof a&&a(b,d),c({data:d,error:b})})})}},{key:"refreshData",value:function(a){return new Promise(function(c){b.refreshDataSource(function(b,d){"function"==typeof a&&a(b,d),c({data:d,error:b})})})}},{key:"refreshRow",value:function(a){return new Promise(function(c){b.refreshCurrentRow(function(b,d){"function"==typeof a&&a(b,d),c({data:d,error:b})})})}},{key:"setCurrentIndex",value:function(a){b.setCurrentIndex(a)}},{key:"setParameter",value:function(){b.setParameter.apply(b,arguments)}},{key:"render",value:function(){return React.createElement(l,e({},this.state,{onCancelEdit:this.cancelEdit,onCurrentIndexChange:this.setCurrentIndex,onDeleteRow:this.deleteRow,onEndEdit:this.endEdit,onFieldChange:this.setFieldValue,onFieldsChange:this.setFieldValues,onRefreshData:this.refreshData,onRefreshRow:this.refreshRow,onSetParameter:this.setParameter},this.props))}}]),n}(React.Component);return m.displayName="".concat(b.getDataSourceId(),"(").concat(function(){return l.displayName||l.name||"Component"}(),")"),m}};return l.properties=["onCancelEdit","onCurrentIndexChange","onEndEdit","onDeleteRow","onFieldChange","onFieldsChange","onRefreshData","onRefreshRow","onSetParameter","canDelete","canUpdate","canInsert","currentIndex","isDirty","isDeleting","isLoading","isSaving","loadError","saveFailed"],l});
