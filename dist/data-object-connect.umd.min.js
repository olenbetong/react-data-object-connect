!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.dataObjectConnect=t()}(this,function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?l(e):t}var h=function(t){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(h){var s=function(s){function c(a){var n;e(this,c),(n=r(this,i(c).call(this,a))).handleAllowDeleteChanged=n.handleAllowDeleteChanged.bind(l(l(n))),n.handleAllowUpdateChanged=n.handleAllowUpdateChanged.bind(l(l(n))),n.handleAllowInsertChanged=n.handleAllowInsertChanged.bind(l(l(n))),n.handleSaveFailed=n.handleSaveFailed.bind(l(l(n))),n.handlePartialDataLoaded=n.handlePartialDataLoaded.bind(l(l(n))),n.handleDataLoadFailed=n.handleDataLoadFailed.bind(l(l(n))),n.handleFieldChanged=n.handleFieldChanged.bind(l(l(n))),n.handleRecordCreated=n.handleRecordCreated.bind(l(l(n))),n.handleRecordRefreshed=n.handleRecordRefreshed.bind(l(l(n))),n.handleRecordDeleting=n.handleRecordDeleting.bind(l(l(n))),n.handleRecordDeleted=n.handleRecordDeleted.bind(l(l(n))),n.handleAfterSave=n.handleAfterSave.bind(l(l(n))),n.handleBeforeSave=n.handleBeforeSave.bind(l(l(n))),n.handleBeforeLoad=n.handleBeforeLoad.bind(l(l(n))),n.handleCancelEdit=n.handleCancelEdit.bind(l(l(n))),n.handleCurrentIndexChanged=n.handleCurrentIndexChanged.bind(l(l(n))),n.handleDataLoaded=n.handleDataLoaded.bind(l(l(n))),n.handleDirtyChanged=n.handleDirtyChanged.bind(l(l(n))),n.setFieldValue=n.setFieldValue.bind(l(l(n))),n.setFieldValues=n.setFieldValues.bind(l(l(n)));var d={};if(o){var h=!0,s=!1,u=void 0;try{for(var f,v=t.getFields()[Symbol.iterator]();!(h=(f=v.next()).done);h=!0)d[f.value.name]=null}catch(e){s=!0,u=e}finally{try{h||null==v.return||v.return()}finally{if(s)throw u}}}else d.data=[];return n.state=Object.assign({canDelete:t.isDeleteAllowed(),canUpdate:t.isUpdateAllowed(),canInsert:t.isInsertAllowed(),currentIndex:t.getCurrentIndex(),isDirty:t.isDirty(),isDeleting:!1,isLoading:!1,isSaving:!1,loadError:null,saveFailed:!1},d),n}return d(c,s),a(c,[{key:"componentDidMount",value:function(){t.attachEvent("onAllowDeleteChanged",this.handleAllowDeleteChanged),t.attachEvent("onAllowUpdateChanged",this.handleAllowUpdateChanged),t.attachEvent("onAllowInsertChanged",this.handleAllowInsertChanged),t.attachEvent("onSaveFailed",this.handleSaveFailed),t.attachEvent("onPartialDataLoaded",this.handlePartialDataLoaded),t.attachEvent("onDataLoadFailed",this.handleDataLoadFailed),t.attachEvent("onFieldChanged",this.handleFieldChanged),t.attachEvent("onRecordCreated",this.handleRecordCreated),t.attachEvent("onRecordRefreshed",this.handleRecordRefreshed),t.attachEvent("onRecordDeleting",this.handleRecordDeleting),t.attachEvent("onRecordDeleted",this.handleRecordDeleted),t.attachEvent("onAfterSave",this.handleAfterSave),t.attachEvent("onBeforeLoad",this.handleBeforeLoad),t.attachEvent("onBeforeSave",this.handleBeforeSave),t.attachEvent("onCancelEdit",this.handleCancelEdit),t.attachEvent("onCurrentIndexChanged",this.handleCurrentIndexChanged),t.attachEvent("onDataLoaded",this.handleDataLoaded),t.attachEvent("onDirtyChanged",this.handleDirtyChanged),this.updateData()}},{key:"componentWillUnmount",value:function(){t.detachEvent("onAllowDeleteChanged",this.handleAllowDeleteChanged),t.detachEvent("onAllowUpdateChanged",this.handleAllowUpdateChanged),t.detachEvent("onAllowInsertChanged",this.handleAllowInsertChanged),t.detachEvent("onSaveFailed",this.handleSaveFailed),t.detachEvent("onPartialDataLoaded",this.handlePartialDataLoaded),t.detachEvent("onDataLoadFailed",this.handleDataLoadFailed),t.detachEvent("onFieldChanged",this.handleFieldChanged),t.detachEvent("onRecordCreated",this.handleRecordCreated),t.detachEvent("onRecordRefreshed",this.handleRecordRefreshed),t.detachEvent("onRecordDeleting",this.handleRecordDeleting),t.detachEvent("onRecordDeleted",this.handleRecordDeleted),t.detachEvent("onAfterSave",this.handleAfterSave),t.detachEvent("onBeforeLoad",this.handleBeforeLoad),t.detachEvent("onBeforeSave",this.handleBeforeSave),t.detachEvent("onCancelEdit",this.handleCancelEdit),t.detachEvent("onCurrentIndexChanged",this.handleCurrentIndexChanged),t.detachEvent("onDataLoaded",this.handleDataLoaded),t.detachEvent("onDirtyChanged",this.handleDirtyChanged)}},{key:"cancelEdit",value:function(){t.cancelEdit()}},{key:"deleteRow",value:function(e){return new Promise(function(a){var n=function(e,t){a({data:t,error:e})};o?t.deleteCurrentRow(n):t.deleteRow(e,n)})}},{key:"endEdit",value:function(e){return new Promise(function(a){t.endEdit(function(t,n){"function"==typeof e&&e(t,n),a({data:n,error:t})})})}},{key:"updateData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(o){var a=t.currentRow();this.setState(Object.assign(a,e))}else{var n=t.getData(),d=t.currentRow();this.setState(Object.assign({current:d,data:n},e))}}},{key:"handleAllowDeleteChanged",value:function(e){this.setState({canDelete:e})}},{key:"handleAllowUpdateChanged",value:function(e){this.setState({canUpdate:e})}},{key:"handleAllowInsertChanged",value:function(e){this.setState({canInsert:e})}},{key:"handleSaveFailed",value:function(){this.setState({saveFailed:!0})}},{key:"handlePartialDataLoaded",value:function(){}},{key:"handleDataLoadFailed",value:function(e){e?this.setState({isLoading:!1,loadError:e}):this.setState({isLoading:!1})}},{key:"handleFieldChanged",value:function(e){e.name,e.value;this.updateData()}},{key:"handleRecordCreated",value:function(){this.updateData()}},{key:"handleRecordRefreshed",value:function(){this.updateData()}},{key:"handleRecordDeleting",value:function(){this.setState({isDeleting:!0})}},{key:"handleRecordDeleted",value:function(){this.updateData({isDeleting:!1})}},{key:"handleAfterSave",value:function(){this.updateData({isSaving:!1})}},{key:"handleBeforeLoad",value:function(){this.setState({isLoading:!0})}},{key:"handleBeforeSave",value:function(){this.setState({isSaving:!0,saveFailed:!1})}},{key:"handleCancelEdit",value:function(){this.updateData({isSaving:!1})}},{key:"handleCurrentIndexChanged",value:function(e){o?this.updateData():(this.updateData(),this.setState({currentIndex:e}))}},{key:"handleDataLoaded",value:function(){this.updateData({isLoading:!1,isSaving:!1,isDeleting:!1,saveFailed:!1})}},{key:"handleDirtyChanged",value:function(){this.setState({isDirty:t.isDirty()})}},{key:"refreshData",value:function(e){return new Promise(function(a){t.refreshDataSource(function(t,n){"function"==typeof e&&e(t,n),a({data:n,error:t})})})}},{key:"refreshRow",value:function(e){return new Promise(function(a){t.refreshCurrentRow(function(t,n){"function"==typeof e&&e(t,n),a({data:n,error:t})})})}},{key:"setFieldValue",value:function(e,a){t.currentRow(e,a),this.updateData()}},{key:"setFieldValues",value:function(e){for(var a in e)e.hasOwnProperty(a)&&t.currentRow(a,e[a]);this.updateData()}},{key:"setCurrentIndex",value:function(e){t.setCurrentIndex(e)}},{key:"setParameter",value:function(){t.setParameter.apply(t,arguments)}},{key:"render",value:function(){return React.createElement(h,n({},this.state,{onCancelEdit:this.cancelEdit,onCurrentIndexChange:this.setCurrentIndex,onDeleteRow:this.deleteRow,onEndEdit:this.endEdit,onFieldChange:this.setFieldValue,onFieldsChange:this.setFieldValues,onRefreshData:this.refreshData,onRefreshRow:this.refreshRow,onSetParameter:this.setParameter},this.props))}}]),c}(React.Component);return s.displayName="".concat(t.getDataSourceId(),"(").concat(function(){return h.displayName||h.name||"Component"}(),")"),s}};return h.properties=["onCancelEdit","onCurrentIndexChange","onEndEdit","onDeleteRow","onFieldChange","onFieldsChange","onRefreshData","onRefreshRow","onSetParameter","canDelete","canUpdate","canInsert","currentIndex","isDirty","isDeleting","isLoading","isSaving","loadError","saveFailed"],h});
